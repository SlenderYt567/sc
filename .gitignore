local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "BloxMinds | Gamepass Unlocker",
   Icon = 0, 
   LoadingTitle = "Analisando Módulos...",
   LoadingSubtitle = "By BloxMinds AI",
   Theme = "Default", 
   ConfigurationSaving = { Enabled = true, FileName = "BloxMinds_GP_Config" },
   KeySystem = false 
})

local Tab = Window:CreateTab("Main", "unlock")
local Section = Tab:CreateSection("Gamepass Manager")

-- Variáveis para armazenar as funções originais (para poder desligar se quiser)
local GamepassController = nil
local OldFunctions = {}
local IsSpoofed = false

-- Tentativa de localizar o módulo com base nos caminhos vistos no seu código
local success, result = pcall(function()
    return require(game:GetService("ReplicatedStorage").Modules.Client.UI.Gamepass.GamepassController)
end)

if success and result then
    GamepassController = result
    Rayfield:Notify({ Title = "Sucesso", Content = "Módulo GamepassController encontrado!", Duration = 5, Image = "check" })
else
    Rayfield:Notify({ Title = "Erro", Content = "Não foi possível encontrar o módulo. O jogo atualizou?", Duration = 5, Image = "x" })
end

-- Função principal de Unlock
local function ToggleGamepasses(state)
    if not GamepassController then return end
    
    if state then
        -- Salvar originais se ainda não salvou
        if not OldFunctions.IsOwned then
            OldFunctions.IsOwned = GamepassController.IsOwned
            OldFunctions.IsPermanentlyOwned = GamepassController.IsPermanentlyOwned
            OldFunctions.IsPlayerOwned = GamepassController.IsPlayerOwned
            OldFunctions.IsPlayerOwnedLegacy = GamepassController.IsPlayerOwnedLegacy
        end

        -- Sobrescrever (Hook) as funções para retornar TRUE
        GamepassController.IsOwned = function(...) return true end
        GamepassController.IsPermanentlyOwned = function(...) return true end
        GamepassController.IsPlayerOwned = function(...) return true end
        GamepassController.IsPlayerOwnedLegacy = function(...) return true end
        
        -- Tentar forçar atualização da UI
        local Signal = require(game:GetService("ReplicatedStorage").Packages.Signal)
        if GamepassController.OnGamepassUnlocked and GamepassController.OnGamepassUnlocked.Fire then
             -- Dispara evento visual de desbloqueio para todos os IDs conhecidos
             for i = 1, 50 do -- Loop genérico para tentar atualizar ícones
                 task.spawn(function() GamepassController.OnGamepassUnlocked:Fire(i) end)
             end
        end

        Rayfield:Notify({ Title = "Unlocked", Content = "Gamepasses liberados visualmente/localmente.", Duration = 3, Image = "unlock" })
    else
        -- Restaurar funções originais
        if OldFunctions.IsOwned then
            GamepassController.IsOwned = OldFunctions.IsOwned
            GamepassController.IsPermanentlyOwned = OldFunctions.IsPermanentlyOwned
            GamepassController.IsPlayerOwned = OldFunctions.IsPlayerOwned
            GamepassController.IsPlayerOwnedLegacy = OldFunctions.IsPlayerOwnedLegacy
        end
        Rayfield:Notify({ Title = "Restored", Content = "Funções originais restauradas.", Duration = 3, Image = "lock" })
    end
end

Tab:CreateToggle({
   Name = "Unlock All Gamepasses (Client)",
   CurrentValue = false,
   Flag = "UnlockGP", 
   Callback = function(Value)
       ToggleGamepasses(Value)
   end,
})

Tab:CreateButton({
   Name = "Forçar Atualização da UI",
   Callback = function()
       -- Tenta recarregar a UI de loja/inventário
       local Players = game:GetService("Players")
       local Gui = Players.LocalPlayer:WaitForChild("PlayerGui")
       -- Isso é genérico, pois depende de como o jogo desenha a tela
       Rayfield:Notify({ Title = "Info", Content = "Tente reabrir o menu do jogo para ver as mudanças.", Duration = 3, Image = "info" })
   end,
})

Section:CreateLabel("Nota: Isso libera o acesso no CLIENTE.")
Section:CreateLabel("Veículos/Itens com verificação no servidor")
Section:CreateLabel("podem não funcionar.")
