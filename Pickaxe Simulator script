--[[
    SlenderHub - Pickaxe Simulator [Integrated Edition]
    Version: 22.0
    Type: Logic based on getgenv().SlenderHubAccessLevel
    Credits: SlenderHub Team
]]

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local VirtualInputManager = game:GetService("VirtualInputManager")
local VirtualUser = game:GetService("VirtualUser")
local Workspace = game:GetService("Workspace")
local CoreGui = game:GetService("CoreGui")

local LocalPlayer = Players.LocalPlayer
local RemotesFolder = ReplicatedStorage:WaitForChild("Paper"):WaitForChild("Remotes")
local RemoteEvent = RemotesFolder:WaitForChild("__remoteevent")
local RemoteFunction = RemotesFolder:WaitForChild("__remotefunction")

-- [ 1. VERIFICA√á√ÉO DE ACESSO (INTEGRADO AO SEU LOADER) ] --
-- O script apenas l√™ a vari√°vel global definida pelo seu Key System anterior
local AccessLevel = getgenv().SlenderHubAccessLevel or "Free"
local isPremium = (AccessLevel == "Premium")

-- [ 2. CONFIGURA√á√ÉO DE VELOCIDADE (Delays) ] --
local Delays = {
    Mine = isPremium and 0.0 or 0.25,      -- Premium: Instant√¢neo | Free: 0.25s
    Train = isPremium and 0.5 or 2.5,      -- Premium: 0.5s | Free: 2.5s
    Egg = isPremium and 0.05 or 1.5,       -- Premium: Turbo | Free: 1.5s
    Craft = isPremium and 0.1 or 1.0       -- Premium: R√°pido | Free: Normal
}

-- [ 3. VARI√ÅVEIS GERAIS ] --
local Flags = {
    AutoMine = false, TPMine = false, AutoSell = false,
    AutoEgg = false, AutoTrain = false, AutoUpgrade = false,
    AutoCraftGold = false, AutoCraftRainbow = false, AutoRebirth = false,
    TargetUpgrade = "More Damage", RebirthAmount = "1"
}

local EggSettings = { SelectedEgg = "Basic Egg", Amount = "Max" }

local EggList = {
    "Basic Egg", "Rare Egg", "Forest Egg", "Black Hole Egg", "UFO Egg", "Garden Egg",
    "Sand Egg", "Snow Egg", "Lava Egg", "Sunny Egg", "Cave Egg", "Sakura Egg",
    "Beach Egg", "Aqua Egg", "Music Egg", "Rocket Egg", "Aura Egg"
}

-- [ 4. UI LIBRARY (SAFE LOAD) ] --
local Success, Rayfield = pcall(function()
    return loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
end)
if not Success then
    Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/shlexware/Rayfield/main/source'))()
end

local WindowName = isPremium and "SlenderHub | üíé PREMIUM" or "SlenderHub | Free Version"

local Window = Rayfield:CreateWindow({
    Name = WindowName,
    LoadingTitle = "SlenderHub V22",
    LoadingSubtitle = "Access Level: " .. AccessLevel,
    ConfigurationSaving = { Enabled = true, FolderName = "SlenderHubV22", FileName = "PickaxeConfig" },
    KeySystem = false -- Desativado pois seu Loader j√° fez isso
})

-- ==================== TAB: FARM ====================
local TabFarm = Window:CreateTab("Farm", 4483362458)

TabFarm:CreateSection("Mining")

local MineTitle = isPremium and "Auto Mine (TURBO ‚ö°)" or "Auto Mine (Normal)"
TabFarm:CreateToggle({
    Name = MineTitle,
    CurrentValue = false,
    Flag = "AutoMine",
    Callback = function(Value)
        Flags.AutoMine = Value
        pcall(function() RemoteEvent:FireServer("Toggle Setting", "AutoMine") end)
        if Value then
            task.spawn(function()
                while Flags.AutoMine do
                    local vp = Workspace.CurrentCamera.ViewportSize
                    VirtualInputManager:SendMouseButtonEvent(vp.X/2, vp.Y/2, 0, true, game, 1)
                    VirtualInputManager:SendMouseButtonEvent(vp.X/2, vp.Y/2, 0, false, game, 1)
                    task.wait(Delays.Mine) -- Usa o delay baseado no acesso
                end
            end)
        end
    end,
})

TabFarm:CreateToggle({
    Name = "TP Mine (Void Mode)",
    CurrentValue = false,
    Flag = "TPMine",
    Callback = function(Value)
        Flags.TPMine = Value
        if Value then
            task.spawn(function()
                while Flags.TPMine do
                    pcall(function()
                        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                            local hrp = LocalPlayer.Character.HumanoidRootPart
                            local closestOre, minDist = nil, 999
                            for _, ore in pairs(Workspace.Mine:GetChildren()) do
                                if ore:IsA("Model") then
                                    local orePos = ore:GetPivot().Position
                                    local dist = (orePos - hrp.Position).Magnitude
                                    if dist < 50 and orePos.Y < hrp.Position.Y then
                                        if dist < minDist then minDist = dist; closestOre = ore end
                                    end
                                end
                            end
                            if closestOre then hrp.CFrame = closestOre:GetPivot() + Vector3.new(0, 6, 0) end
                        end
                    end)
                    task.wait(0.1)
                end
            end)
        end
    end,
})

TabFarm:CreateSection("Training")
local TrainTitle = isPremium and "Auto Train (TURBO üî•)" or "Auto Train (Normal)"
TabFarm:CreateToggle({
    Name = TrainTitle,
    CurrentValue = false,
    Flag = "AutoTrain",
    Callback = function(Value)
        Flags.AutoTrain = Value
        if Value then
            task.spawn(function()
                while Flags.AutoTrain do
                    pcall(function() RemoteEvent:FireServer("Toggle Setting", "AutoTrain") end)
                    task.wait(Delays.Train)
                end
            end)
        end
    end,
})

-- ==================== TAB: EGGS ====================
local TabEgg = Window:CreateTab("Eggs", 4483362458)

TabEgg:CreateSection("Settings")
TabEgg:CreateDropdown({
    Name = "Select Egg",
    Options = EggList,
    CurrentOption = {"Basic Egg"},
    Callback = function(Option) EggSettings.SelectedEgg = Option[1] end,
})

TabEgg:CreateDropdown({
    Name = "Amount",
    Options = {"1", "3", "6", "12", "Max"},
    CurrentOption = {"Max"},
    Callback = function(Option) EggSettings.Amount = Option[1] end,
})

local EggTitle = isPremium and "Auto Open (INSTANT ü•ö)" or "Auto Open (Slow)"
TabEgg:CreateToggle({
    Name = EggTitle,
    CurrentValue = false,
    Flag = "AutoEgg",
    Callback = function(Value)
        Flags.AutoEgg = Value
        if Value then
            task.spawn(function()
                while Flags.AutoEgg do
                    local args = {"Hatch Egg", EggSettings.SelectedEgg, EggSettings.Amount}
                    pcall(function() RemoteFunction:InvokeServer(unpack(args)) end)
                    task.wait(Delays.Egg)
                end
            end)
        end
    end,
})

TabEgg:CreateButton({
    Name = "Delete Egg Models (FPS Boost)",
    Callback = function()
        if Workspace:FindFirstChild("Eggs") then
            for _, egg in pairs(Workspace.Eggs:GetChildren()) do egg:Destroy() end
            Rayfield:Notify({Title = "Success", Content = "Egg Models Removed", Duration = 3})
        end
    end,
})

-- ==================== TAB: PETS ====================
local TabPets = Window:CreateTab("Pets", 4483362458)
TabPets:CreateSection("Auto Craft (100% Success)")

local function CraftPets(action, targetTier)
    local petsFolder = LocalPlayer:FindFirstChild("Stats") and LocalPlayer.Stats:FindFirstChild("Pets")
    if not petsFolder then return end

    local groupedPets = {}
    for _, pet in pairs(petsFolder:GetChildren()) do
        local pName = pet:GetAttribute("PetName")
        local pTier = pet:GetAttribute("Tier")
        if pName and pTier == targetTier and not pet:GetAttribute("Locked") then
            if not groupedPets[pName] then groupedPets[pName] = {} end
            table.insert(groupedPets[pName], pet.Name)
        end
    end

    for petName, uuidList in pairs(groupedPets) do
        while #uuidList >= 8 do
            local batch = {}
            for i = 1, 8 do table.insert(batch, table.remove(uuidList)) end
            local args = {"Pet", {Action = action, Pets = batch}}
            pcall(function() RemoteFunction:InvokeServer(unpack(args)) end)
            task.wait(Delays.Craft)
        end
    end
end

TabPets:CreateToggle({
    Name = "Auto Craft Golden",
    CurrentValue = false,
    Callback = function(Value)
        Flags.AutoCraftGold = Value
        if Value then
            task.spawn(function()
                while Flags.AutoCraftGold do CraftPets("CraftGolden", 1); task.wait(2) end
            end)
        end
    end,
})

TabPets:CreateToggle({
    Name = "Auto Craft Rainbow",
    CurrentValue = false,
    Callback = function(Value)
        Flags.AutoCraftRainbow = Value
        if Value then
            task.spawn(function()
                while Flags.AutoCraftRainbow do CraftPets("CraftRainbow", 2); task.wait(2) end
            end)
        end
    end,
})

-- ==================== TAB: PREMIUM INFO ====================
local TabPremium = Window:CreateTab("Info", 4483362458)

if isPremium then
    TabPremium:CreateSection("Account Status: PREMIUM ‚úÖ")
    TabPremium:CreateParagraph({Title = "Active Benefits", Content = "‚Ä¢ 0 Delay Mining\n‚Ä¢ 0 Delay Hatching\n‚Ä¢ Turbo Train"})
else
    TabPremium:CreateSection("Account Status: FREE ‚ùå")
    TabPremium:CreateParagraph({Title = "Limited Version", Content = "You are experiencing limited speeds.\nUpgrade to Premium for Instant actions."})
end

-- ==================== TAB: MISC ====================
local TabMisc = Window:CreateTab("Misc", 4483362458)
TabMisc:CreateButton({
    Name = "Clean Map (FPS Boost)",
    Callback = function()
        local folders = {"ExclusiveStands", "Passes", "Confetti"}
        for _, f in pairs(folders) do if Workspace:FindFirstChild(f) then Workspace[f]:Destroy() end end
        Rayfield:Notify({Title = "Cleaned", Content = "Map objects removed.", Duration = 3})
    end,
})
TabMisc:CreateButton({Name = "Destroy UI", Callback = function() Rayfield:Destroy() end})

-- Anti-AFK
LocalPlayer.Idled:Connect(function() VirtualUser:CaptureController(); VirtualUser:ClickButton2(Vector2.new()) end)

Rayfield:Notify({
    Title = "SlenderHub Loaded",
    Content = "Access Level: " .. AccessLevel,
    Duration = 5,
    Image = 4483362458,
})
