--[[
    SlenderHub | V1 - Horse Race (Premium OP Edition)
    Architect: SlenderHub Team
    Access Level: Dynamic (Free/Premium)
]]

-- 1. SlenderHub Singleton Pattern
if getgenv().SlenderHubLoaded then 
    warn("SlenderHub V1 Already Running") 
    return 
end
getgenv().SlenderHubLoaded = true

-- 2. Check Access Level (Defined by Key System)
local AccessLevel = getgenv().SlenderHubAccessLevel or "Free" 
local IsPremium = (AccessLevel == "Premium")

-- 3. Load Library
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- 4. Services
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")
local LocalPlayer = Players.LocalPlayer

-- 5. Remote Analysis & Retrieval (Knit Framework Hook)
local function GetRemote(ServiceName, RemoteName, IsFunction)
    local Remote = nil
    pcall(function()
        local Knit = ReplicatedStorage.Packages._Index["sleitnick_knit@1.5.1"].knit.Services
        local Service = Knit:FindFirstChild(ServiceName)
        if Service then
            local Folder = Service:FindFirstChild(IsFunction and "RF" or "RE")
            if Folder then Remote = Folder:FindFirstChild(RemoteName) end
        end
    end)
    return Remote
end

-- 6. Control Variables
local Flags = {
    AutoWin = false, AutoWinOP = false, AutoTrain = false, AutoHatch = false, AutoBuy = false, 
    AutoClaimExclusive = false, AutoCrate = false, SpeedHack = false, Noclip = false, InfJump = false,
    TrainWorld = "1", TrainMachine = "1",
    SelectedEgg = "Egg_1_1", VendingItem = "WPN_101",
    SelectedArea = "Area_1", SelectedCrate = "Crate_1",
    WalkSpeedVal = 100
}

-- 7. UI Construction
local HubTitle = "SlenderHub | V1 [" .. string.upper(AccessLevel) .. "]"

local Window = Rayfield:CreateWindow({
   Name = HubTitle,
   LoadingTitle = "Authenticating...",
   LoadingSubtitle = "Welcome, " .. LocalPlayer.Name,
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "SlenderHub",
      FileName = "HorseRaceConfig"
   },
   KeySystem = false
})

Rayfield:Notify({
    Title = "Access Granted",
    Content = "Logged in as: " .. AccessLevel .. " User",
    Duration = 5
})

-- =================================================================
-- TAB: PREMIUM OP (ONLY VISIBLE/ACTIVE FOR PREMIUM)
-- =================================================================
if IsPremium then
    local TabOP = Window:CreateTab("Premium OP")
    
    TabOP:CreateSection("Blatant Farming")
    
    TabOP:CreateToggle({
       Name = "âš¡ SUPER Auto Win (5x Speed)",
       CurrentValue = false,
       Callback = function(Value)
            Flags.AutoWinOP = Value
            local Remote = GetRemote("FightService", "GetWinsEvent", false)
            local Vector = Vector3.new(1811.09, 782.79, -689544.81)
            
            task.spawn(function()
                while Flags.AutoWinOP do
                    if Remote then 
                        -- OP LOGIC: Fire multiple times per frame
                        for i = 1, 5 do
                            pcall(function() Remote:FireServer("WinGate_16", Vector) end)
                        end
                    else 
                        Remote = GetRemote("FightService", "GetWinsEvent", false) 
                    end
                    task.wait(0.01) -- Extreme Speed
                end
            end)
       end,
    })

    TabOP:CreateSection("Character Exploits")

    TabOP:CreateToggle({
       Name = "Speed Hack (Loop Bypass)",
       CurrentValue = false,
       Callback = function(Value)
            Flags.SpeedHack = Value
            task.spawn(function()
                while Flags.SpeedHack and task.wait() do
                    pcall(function()
                        LocalPlayer.Character.Humanoid.WalkSpeed = Flags.WalkSpeedVal
                    end)
                end
                pcall(function() LocalPlayer.Character.Humanoid.WalkSpeed = 16 end)
            end)
       end,
    })

    TabOP:CreateSlider({
       Name = "Speed Value",
       Range = {16, 500},
       Increment = 1,
       Suffix = "Speed",
       CurrentValue = 100,
       Callback = function(Value)
           Flags.WalkSpeedVal = Value
       end,
    })

    TabOP:CreateToggle({
       Name = "Noclip (Walk Through Walls)",
       CurrentValue = false,
       Callback = function(Value)
            Flags.Noclip = Value
            if Flags.Noclip then
                RunService:BindToRenderStep("SlenderNoclip", 1000, function()
                    if LocalPlayer.Character then
                        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                            if part:IsA("BasePart") then part.CanCollide = false end
                        end
                    end
                end)
            else
                RunService:UnbindFromRenderStep("SlenderNoclip")
            end
       end,
    })

    TabOP:CreateToggle({
       Name = "Infinite Jump",
       CurrentValue = false,
       Callback = function(Value)
            Flags.InfJump = Value
            game:GetService("UserInputService").JumpRequest:Connect(function()
                if Flags.InfJump and LocalPlayer.Character then
                    LocalPlayer.Character:FindFirstChildOfClass('Humanoid'):ChangeState("Jumping")
                end
            end)
       end,
    })
else
    -- Placeholder for Free Users to see what they are missing
    local TabOP = Window:CreateTab("Premium ðŸ”’")
    TabOP:CreateButton({
        Name = "ðŸ”’ Unlock OP Features (Super Win, Speed)",
        Callback = function()
            Rayfield:Notify({Title="Premium Required", Content="Get a key at SlenderHub.shop", Duration=3})
        end,
    })
end

-- =================================================================
-- TAB: FARM (NORMAL)
-- =================================================================
local TabFarm = Window:CreateTab("Farm")

TabFarm:CreateSection("Legit Farm")
TabFarm:CreateToggle({
   Name = "Auto Win (Normal Speed)",
   CurrentValue = false,
   Callback = function(Value)
        Flags.AutoWin = Value
        local Remote = GetRemote("FightService", "GetWinsEvent", false)
        local Vector = Vector3.new(1811.09, 782.79, -689544.81)
        
        task.spawn(function()
            while Flags.AutoWin and task.wait(0.1) do
                if Remote then 
                    pcall(function() Remote:FireServer("WinGate_16", Vector) end)
                else 
                    Remote = GetRemote("FightService", "GetWinsEvent", false) 
                end
            end
        end)
   end,
})

TabFarm:CreateSection("Auto Train")
TabFarm:CreateDropdown({
    Name = "Mundo (World)", Options = {"1","2","3","4","5"}, CurrentOption = {"1"},
    Callback = function(O) Flags.TrainWorld = O[1] end
})
TabFarm:CreateDropdown({
    Name = "MÃ¡quina (Machine)", Options = {"1","2","3","4","5","6","7","8","9","10","11","12"}, CurrentOption = {"1"},
    Callback = function(O) Flags.TrainMachine = O[1] end
})
TabFarm:CreateToggle({
   Name = "Ativar Treino (Auto Train)",
   CurrentValue = false,
   Callback = function(Value)
        Flags.AutoTrain = Value
        local Remote = GetRemote("TrainService", "RunTrain", false)
        task.spawn(function()
            while Flags.AutoTrain and task.wait() do
                if Remote then
                    pcall(function() Remote:FireServer("Treadmill_"..Flags.TrainWorld.."_"..Flags.TrainMachine) end)
                else Remote = GetRemote("TrainService", "RunTrain", false) end
            end
        end)
   end,
})

-- =================================================================
-- TAB: TELEPORT
-- =================================================================
local TabTP = Window:CreateTab("Teleport")
local Areas = { "Area_1", "Area_2", "Area_3", "Area_4", "Area_5", "Area_Christmas", "Area_Fruit" }

TabTP:CreateSection("Zone Teleport")
TabTP:CreateDropdown({
    Name = "Selecionar Area", Options = Areas, CurrentOption = {"Area_1"},
    Callback = function(Option) Flags.SelectedArea = Option[1] end,
})
TabTP:CreateButton({
    Name = "Teleportar Agora",
    Callback = function()
        local TargetArea = Flags.SelectedArea
        local Remote = GetRemote("AreaService", "UpdatePlayerCurrentArea", false)
        if Remote then pcall(function() Remote:FireServer(TargetArea) end) end

        pcall(function()
            local Root = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if Root then
                local TargetObj = workspace:FindFirstChild(TargetArea) 
                               or (workspace:FindFirstChild("Spawns") and workspace.Spawns:FindFirstChild(TargetArea))
                               or (workspace:FindFirstChild("Map") and workspace.Map:FindFirstChild(TargetArea))
                if TargetObj then
                    local TargetCFrame = TargetObj:IsA("Model") and TargetObj:GetPivot() or TargetObj.CFrame
                    Root.CFrame = TargetCFrame + Vector3.new(0, 5, 0)
                    Rayfield:Notify({Title="Teleport", Content="Teleportado para: " .. TargetArea, Duration=2})
                end
            end
        end)
    end,
})

-- =================================================================
-- TAB: EGGS
-- =================================================================
local TabEggs = Window:CreateTab("Eggs")
local EggIDs = { "Egg_1_1", "Egg_1_2", "Egg_1_3", "Egg_1_4", "Egg_2_1", "Egg_2_2", "Egg_2_3", "Egg_2_4", "Egg_3_1", "Egg_3_2", "Egg_3_3", "Egg_3_4", "Egg_4_1", "Egg_4_2", "Egg_4_3", "Egg_Tower_1", "Egg_Christmas" }

TabEggs:CreateDropdown({
    Name = "Escolher Ovo", Options = EggIDs, CurrentOption = {"Egg_1_1"},
    Callback = function(O) Flags.SelectedEgg = O[1] end
})
TabEggs:CreateToggle({
   Name = "Auto Hatch (Fast)",
   CurrentValue = false,
   Callback = function(Value)
        Flags.AutoHatch = Value
        local Remote = GetRemote("EggHatchService", "Hatch", false)
        task.spawn(function()
            while Flags.AutoHatch do
                if Remote then pcall(function() Remote:FireServer(Flags.SelectedEgg, 1) end)
                else Remote = GetRemote("EggHatchService", "Hatch", false) end
                task.wait(0.25)
            end
        end)
   end,
})

TabEggs:CreateSection("Premium Rewards")
if IsPremium then
    TabEggs:CreateToggle({
       Name = "Auto Claim Exclusive Egg (OP)",
       CurrentValue = false,
       Callback = function(Value)
            Flags.AutoClaimExclusive = Value
            local Remote = GetRemote("OnlineRewardService", "ClaimOnlineQuestReward", true)
            task.spawn(function()
                while Flags.AutoClaimExclusive do
                    if Remote then pcall(function() Remote:InvokeServer() end)
                    else Remote = GetRemote("OnlineRewardService", "ClaimOnlineQuestReward", true) end
                    task.wait(5)
                end
            end)
       end,
    })
else
    TabEggs:CreateButton({
        Name = "ðŸ”’ Auto Exclusive Egg (PREMIUM)",
        Callback = function() Rayfield:Notify({Title="Access Denied", Content="Premium Only", Duration=3}) end,
    })
end

-- =================================================================
-- TAB: SHOP
-- =================================================================
local TabShop = Window:CreateTab("Shop")
local VendingItems = { "WPN_101", "WPN_102", "Potion_DoubleWins", "Potion_SuperLucky", "KingSlime" }

TabShop:CreateSection("Vending Machine")
TabShop:CreateDropdown({
    Name = "Item", Options = VendingItems, CurrentOption = {"WPN_101"},
    Callback = function(O) Flags.VendingItem = O[1] end
})
TabShop:CreateToggle({
   Name = "Auto Buy Item",
   CurrentValue = false,
   Callback = function(Value)
       Flags.AutoBuy = Value
       local Remote = GetRemote("PurchaseService", "PromptPurchase", false)
       task.spawn(function()
           while Flags.AutoBuy and task.wait(0.5) do
               if Remote then pcall(function() Remote:Fire(Flags.VendingItem) end)
               else Remote = GetRemote("PurchaseService", "PromptPurchase", false) end
           end
       end)
   end,
})

TabShop:CreateSection("Premium Crates")
if IsPremium then
    TabShop:CreateDropdown({
        Name = "Select Crate", Options = {"Crate_1", "Crate_2"}, CurrentOption = {"Crate_1"},
        Callback = function(O) Flags.SelectedCrate = O[1] end
    })
    TabShop:CreateToggle({
       Name = "Auto Open Crate (OP)",
       CurrentValue = false,
       Callback = function(Value)
           Flags.AutoCrate = Value
           local Remote = GetRemote("ItemCrateService", "UnboxCrate", false)
           task.spawn(function()
               while Flags.AutoCrate and task.wait(0.5) do
                   if Remote then pcall(function() Remote:FireServer(Flags.SelectedCrate) end)
                   else Remote = GetRemote("ItemCrateService", "UnboxCrate", false) end
               end
           end)
       end,
    })
else
    TabShop:CreateButton({
        Name = "ðŸ”’ Auto Open Crate (PREMIUM)",
        Callback = function() Rayfield:Notify({Title="Access Denied", Content="Premium Only", Duration=3}) end,
    })
end

-- =================================================================
-- TAB: MISC
-- =================================================================
local TabMisc = Window:CreateTab("Misc")
TabMisc:CreateButton({
    Name = "Anti-AFK (Low Render)",
    Callback = function()
        RunService:Set3dRenderingEnabled(false)
        LocalPlayer.Idled:connect(function()
            VirtualUser:Button2Down(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
            wait(1)
            VirtualUser:Button2Up(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
        end)
    end,
})
TabMisc:CreateButton({
    Name = "Restore Rendering",
    Callback = function() RunService:Set3dRenderingEnabled(true) end
})

Rayfield:LoadConfiguration()
