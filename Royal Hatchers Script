local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/SlenderYt567/sc/refs/heads/main/SlenderWind.lua"))()
local Window = Library.Window({ Name = "SlenderHub", KeySystem = false })

-- Espera o jogo carregar
repeat task.wait() until game:IsLoaded()

-- Serviços do Roblox
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer

-- Variáveis de Controle globais (getgenv)
local getgenv = getgenv or function() return _G end
getgenv().AutoClick = false
getgenv().AutoEgg = false
getgenv().SelectedEgg = "Common Egg"
getgenv().EggAmount = 100
getgenv().AutoMerchant = false
getgenv().AutoCollect = false
getgenv().AutoUpgrade = false
getgenv().SelectedUpgrade = "Coins1"
getgenv().AntiAFKMovement = false
getgenv().AutoCreateClan = false
getgenv().ClanNameToCreate = "SlenderHub Clan" -- Nome de clã padrão
getgenv().AutoAcceptInvites = false
getgenv().AutoLeaveClan = false
getgenv().WalkSpeed = 16 -- Adicionado para armazenar o valor do WalkSpeed
getgenv().JumpPower = 50  -- Adicionado para armazenar o valor do JumpPower

-- Anti-AFK padrão (desabilita o evento de ociosidade do jogador)
for _, con in pairs(getconnections(LocalPlayer.Idled)) do
    con:Disable()
end

-- Espera pelos remotes necessários ANTES de criar a GUI para evitar que a GUI não apareça devido a yield
local Remotes = ReplicatedStorage:WaitForChild("Remotes")
local Functions = Remotes:WaitForChild("Functions")
local Events = Remotes:WaitForChild("Events")

-- Remotes específicos
local ClickRemote = Functions:WaitForChild("Click")
local CollectCollectibleRemote = Functions:WaitForChild("CollectCollectible")
local BuyEggRemote = Functions:WaitForChild("BuyEgg")
local BuyMerchantRemote = Functions:WaitForChild("BuyMerchant")
local BuyUpgradeRemote = Functions:WaitForChild("BuyUpgrade")
local ClanRemote = Functions:WaitForChild("ClanInvoke") -- Remote para operações de clã

-- Eventos específicos
local LoadCollectiblesEvent = Events:WaitForChild("LoadCollectibles")
local UpdateClansEvent = Events:WaitForChild("UpdateClans")

-- Tabelas de Dados extraídas da sua Dex (ATUALIZADAS)
local AllEggs = {
    "Common Egg", "Spotted Egg", "Rocky Egg", "Mushroom Egg", "Leaf Egg",
    "Arctic Egg", "Icy Egg", "Release Egg", "Lovely Egg", "Valentines Egg",
    "100K Egg", "Desert Egg", "Fiery Egg", "Magma Egg", "500K Egg",
    "Crystal Egg", "Floral Egg", "Mystical Egg", "Season 1 Egg",
    "Bounty Pets", "Exclusive Pets"
}

local AllUpgrades = {
    "Coins1", "EggHatch1", "Gems1", "HatchSpeed1", "Coins2", "Luck1",
    "Shiny1", "HatchSpeed2", "Coins3", "Gems2", "Luck2", "Shiny2",
    "Hatcher1", "Shiny3", "Coins4", "Luck3", "EggHatch2", "Shiny4",
    "Coins5", "Luck4", "EggHatch3", "HiddenLuck", "HiddenShinyLuck", "HiddenHatchSpeed"
}

--================= TABS =================--
local TabFarming = Window:Tab("Farming")
local TabEggs = Window:Tab("Eggs")
local TabShop = Window:Tab("Shop & Upgrades")
local TabClans = Window:Tab("Clans")
local TabPlayer = Window:Tab("Player")

--================= FARMING TAB =================--
TabFarming:Toggle({
    Text = "Auto Click",
    State = getgenv().AutoClick,
    Callback = function(Value)
        getgenv().AutoClick = Value
        task.spawn(function()
            while getgenv().AutoClick do
                pcall(function()
                    ClickRemote:InvokeServer()
                end)
                task.wait() -- Sem delay para máxima velocidade de click
            end
        end)
    end
})

-- Implementação melhorada do Auto Collectibles, usando o Remote "CollectCollectible"
local collectibleIdsToCollect = {} -- Armazena os IDs dos coletáveis para coleta

-- Escuta o evento LoadCollectibles para popular a lista de IDs
LoadCollectiblesEvent.OnClientEvent:Connect(function(collectiblesData)
    for _, data in pairs(collectiblesData) do
        table.insert(collectibleIdsToCollect, data.ID)
    end
end)

TabFarming:Toggle({
    Text = "Auto Collectibles (Gems/Drops)",
    State = getgenv().AutoCollect,
    Callback = function(Value)
        getgenv().AutoCollect = Value
        task.spawn(function()
            while getgenv().AutoCollect do
                pcall(function()
                    for i = #collectibleIdsToCollect, 1, -1 do
                        local collectibleID = collectibleIdsToCollect[i]
                        CollectCollectibleRemote:InvokeServer(collectibleID)
                        table.remove(collectibleIdsToCollect, i)
                    end
                end)
                task.wait(0.1) -- Pequeno delay para evitar spam excessivo no servidor
            end
        end)
    end
})

--================= EGGS TAB =================--
TabEggs:Dropdown({
    Text = "Select Egg",
    Options = AllEggs,
    Selected = getgenv().SelectedEgg, -- SlenderWind usa 'Selected' para a opção inicial
    Callback = function(Option)
        getgenv().SelectedEgg = Option
    end
})

TabEggs:Slider({
    Text = "Amount to Open",
    Min = 1,
    Max = 100,
    Default = getgenv().EggAmount,
    Suffix = " Eggs",
    Callback = function(Value)
        getgenv().EggAmount = Value
    end
})

TabEggs:Toggle({
    Text = "Auto Hatch",
    State = getgenv().AutoEgg,
    Callback = function(Value)
        getgenv().AutoEgg = Value
        task.spawn(function()
            while getgenv().AutoEgg do
                pcall(function()
                    local eggFolder = Workspace:FindFirstChild("_") and Workspace._:FindFirstChild("Eggs")
                    if eggFolder and eggFolder:FindFirstChild(getgenv().SelectedEgg) then
                        BuyEggRemote:InvokeServer(eggFolder[getgenv().SelectedEgg], getgenv().EggAmount)
                    end
                end)
                task.wait(0.05) -- Pequeno delay para segurança e evitar rate-limits
            end
        end)
    end
})

--================= SHOP & UPGRADES TAB =================--
TabShop:Toggle({
    Text = "Auto Buy Merchant (All Items)",
    State = getgenv().AutoMerchant,
    Callback = function(Value)
        getgenv().AutoMerchant = Value
        task.spawn(function()
            while getgenv().AutoMerchant do
                pcall(function()
                    -- Compra todos os 15 slots (assumindo que o merchant sempre tem 15 slots)
                    for i = 1, 15 do
                        BuyMerchantRemote:InvokeServer("Merchant", i)
                    end
                end)
                task.wait(2) -- Delay de 2s para não dar spam excessivo e respeitar cooldowns do servidor
            end
        end)
    end
})

TabShop:Dropdown({
    Text = "Select Upgrade",
    Options = AllUpgrades,
    Selected = getgenv().SelectedUpgrade,
    Callback = function(Option)
        getgenv().SelectedUpgrade = Option
    end
})

TabShop:Toggle({
    Text = "Auto Buy Upgrade",
    State = getgenv().AutoUpgrade,
    Callback = function(Value)
        getgenv().AutoUpgrade = Value
        task.spawn(function()
            while getgenv().AutoUpgrade do
                pcall(function()
                    BuyUpgradeRemote:InvokeServer(getgenv().SelectedUpgrade)
                end)
                task.wait(1) -- Delay para evitar spam excessivo
            end
        end)
    end
})

--================= CLANS TAB =================--
TabClans:Input({
    Text = "Clan Name to Create",
    Placeholder = "Enter clan name",
    Default = getgenv().ClanNameToCreate,
    Callback = function(Value)
        getgenv().ClanNameToCreate = Value
    end
})

TabClans:Toggle({
    Text = "Auto Create Clan",
    State = getgenv().AutoCreateClan,
    Callback = function(Value)
        getgenv().AutoCreateClan = Value
        if Value then
            task.spawn(function()
                while getgenv().AutoCreateClan do
                    -- Verifica se já estamos em um clã antes de tentar criar
                    if not LocalPlayer:GetAttribute("Clan") then
                        pcall(function()
                            local success = ClanRemote:InvokeServer("CreateClan", getgenv().ClanNameToCreate)
                            if success == true then
                                warn("SlenderHub: Clã criado com sucesso:", getgenv().ClanNameToCreate)
                                getgenv().AutoCreateClan = false -- Desativa após criar com sucesso
                            elseif type(success) == "string" then
                                warn("SlenderHub: Falha ao criar clã:", success)
                            end
                        end)
                    else
                        warn("SlenderHub: Já está em um clã, desativando Auto Create Clan.")
                        getgenv().AutoCreateClan = false -- Desativa se já estiver em um clã
                    end
                    task.wait(5) -- Espera um pouco antes de tentar novamente
                end
            end)
        end
    end
})

TabClans:Toggle({
    Text = "Auto Accept Clan Invites",
    State = getgenv().AutoAcceptInvites,
    Callback = function(Value)
        getgenv().AutoAcceptInvites = Value
        if Value then
            -- Conecta ao evento que notifica sobre convites de clã
            UpdateClansEvent.OnClientEvent:Connect(function(eventType, data)
                if getgenv().AutoAcceptInvites and eventType == "InvitesUpdate" and data then
                    for _, clanName in pairs(data) do
                        pcall(function()
                            local success = ClanRemote:InvokeServer("JoinClan", clanName)
                            if success == true then
                                warn("SlenderHub: Convite para o clã '" .. clanName .. "' aceito com sucesso!")
                                getgenv().AutoAcceptInvites = false -- Desativa após aceitar um convite
                            elseif type(success) == "string" then
                                warn("SlenderHub: Falha ao aceitar convite para o clã '" .. clanName .. "':", success)
                            end
                        end)
                        task.wait(0.5) -- Pequeno delay entre aceitar convites
                    end
                end
            end)
        end
    end
})

TabClans:Toggle({
    Text = "Auto Leave/Delete Clan",
    State = getgenv().AutoLeaveClan,
    Callback = function(Value)
        getgenv().AutoLeaveClan = Value
        if Value then
            task.spawn(function()
                while getgenv().AutoLeaveClan do
                    task.wait(1)
                    -- Verifica se o jogador está em um clã
                    if LocalPlayer:GetAttribute("Clan") then
                        pcall(function()
                            local success = ClanRemote:InvokeServer("LeaveClan")
                            if success == true then
                                warn("SlenderHub: Clã deixado/deletado com sucesso.")
                                -- Não desativa aqui, permite que continue tentando se o jogador for forçado a entrar novamente
                            elseif type(success) == "string" then
                                warn("SlenderHub: Falha ao deixar/deletar clã:", success)
                            end
                        end)
                    end
                end
            end)
        end
    end
})

--================= PLAYER TAB =================--
TabPlayer:Slider({
    Text = "WalkSpeed",
    Min = 16,
    Max = 200,
    Default = getgenv().WalkSpeed,
    Suffix = " WS",
    Callback = function(Value)
        getgenv().WalkSpeed = Value -- Armazena o valor globalmente
        local char = LocalPlayer.Character
        local hum = char and char:FindFirstChildOfClass("Humanoid")
        if hum then
            hum.WalkSpeed = Value
        end
    end
})

TabPlayer:Slider({
    Text = "JumpPower",
    Min = 50,
    Max = 300,
    Default = getgenv().JumpPower,
    Suffix = " JP",
    Callback = function(Value)
        getgenv().JumpPower = Value -- Armazena o valor globalmente
        local char = LocalPlayer.Character
        local hum = char and char:FindFirstChildOfClass("Humanoid")
        if hum then
            hum.JumpPower = Value
            hum.UseJumpPower = true -- Garante que o JumpPower seja usado
        end
    end
})

TabPlayer:Toggle({
    Text = "Anti-AFK (Jump a cada 5 minutos)",
    State = getgenv().AntiAFKMovement,
    Callback = function(Value)
        getgenv().AntiAFKMovement = Value
        if Value then
            task.spawn(function()
                while getgenv().AntiAFKMovement do
                    task.wait(300) -- Espera 5 minutos (300 segundos)
                    if getgenv().AntiAFKMovement then -- Verifica novamente caso o toggle tenha sido desativado durante a espera
                        local char = LocalPlayer.Character
                        local hum = char and char:FindFirstChildOfClass("Humanoid")
                        if hum and hum.Health > 0 then
                            -- Simula um pequeno pulo para manter a atividade
                            hum.Jump = true
                            task.wait(0.1) -- Mantém o pulo por um breve momento
                            hum.Jump = false
                        end
                    end
                end
            end)
        end
    end
})

-- Reaplica WalkSpeed e JumpPower quando o personagem é adicionado/respawna
LocalPlayer.CharacterAdded:Connect(function(character)
    local humanoid = character:WaitForChild("Humanoid")
    -- Reaplica os valores armazenados globalmente pelos sliders
    humanoid.WalkSpeed = getgenv().WalkSpeed
    humanoid.JumpPower = getgenv().JumpPower
    humanoid.UseJumpPower = true
end)
